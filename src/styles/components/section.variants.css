/* =========================================================================================
   FILE: src/styles/components/section.variants.css
   SCOPE: Variant flourishes for Section (hero overlays, zig-zag cards, gallery polish, etc.)
   REQ: Load AFTER src/styles/components/section.css
   ========================================================================================= */
@layer components {

  /* --------------------------------------
     0) UTILITIES & SHARED DECOR
  --------------------------------------- */
  @keyframes float-subtle { from {transform:translateY(0)} 50%{transform:translateY(-6px)} to{transform:translateY(0)} }
  @keyframes pulse-glow  { from {opacity:.6} 50%{opacity:1} to{opacity:.6} }
  @keyframes gallery-in { to { opacity:1; transform: translateY(0); } }

  /* Soft vignette helper (no external assets) */
  [data-clean-root="true"] .u-vignette::before {
    content:""; position:absolute; inset:-10%;
    pointer-events:none; z-index:1;
    background:
      radial-gradient(120% 80% at 50% 100%, rgba(0,0,0,.25) 0%, rgba(0,0,0,0) 60%),
      radial-gradient(80% 50% at 50% 0%, rgba(0,0,0,.18) 0%, rgba(0,0,0,0) 55%);
    mix-blend-mode:multiply;
  }

  /* --------------------------------------
     1) LEGACY FULL-CENTERED
     Goal: replicate your "everything centered" legacy look
     Usage: <Section variant="legacy-centered" />
  --------------------------------------- */
  [data-clean-root="true"] .section[data-variant="legacy-centered"] .section__rail {
    max-width: var(--rail-content);
    padding-inline: var(--rail-gutter) !important;
  }
  [data-clean-root="true"] .section[data-variant="legacy-centered"] .section__header {
    max-width: var(--rail-content); margin-inline:auto; text-align:center;
  }
  [data-clean-root="true"] .section[data-variant="legacy-centered"] .section__content {
    margin-inline:auto;
  }

  /* --------------------------------------
     2) HEADER-CENTER + CONTENT-LEFT
     Header stays centered/prose; content snaps left rail.
     Usage: <Section variant="header-center-content-left" />
  --------------------------------------- */
  [data-clean-root="true"] .section[data-variant="header-center-content-left"] .section__rail--header {
    max-width: var(--rail-prose);
    margin-inline:auto; padding-inline: var(--rail-gutter);
  }
  [data-clean-root="true"] .section[data-variant="header-center-content-left"] .section__header {
    text-align:center; margin-inline:auto;
  }
  /* Content already aligns left via base rail rules; ensure no accidental inner padding */
  [data-clean-root="true"] .section[data-variant="header-center-content-left"] .section__content > * {
    /* kill stray "container" paddings that break the left rail */
    padding-inline: 0;
  }

  /* --------------------------------------
     3) HOME HERO (2024) – gradient overlay, parallax, scroll cue
     Usage: <Section variant="home-hero-2024" height="screen" background="image" overlay="soft" tone="dark" />
  --------------------------------------- */
  [data-clean-root="true"] .section[data-variant="home-hero-2024"] {
    isolation:isolate; /* let overlays blend without leaking */
  }
  /* Multi-layer overlay: warm gold from bottom + rose sweep */
  [data-clean-root="true"] .section[data-variant="home-hero-2024"] .section__overlay {
    background:
      linear-gradient(0deg, rgba(44,36,26,.55) 0%, rgba(44,36,26,.15) 40%, rgba(44,36,26,0) 70%),
      radial-gradient(120% 65% at 50% 110%, rgba(228,200,150,.28) 0%, rgba(228,200,150,0) 55%),
      linear-gradient(135deg, rgba(157,107,123,.18) 0%, rgba(157,107,123,0) 55%);
  }
  /* Parallax feel (without JS) for fixed heroes */
  @media (min-width: 1024px) {
    [data-clean-root="true"] .section[data-variant="home-hero-2024"][data-bg="image"] {
      background-attachment: fixed;
    }
  }
  /* Title lift + subtle glow on dark */
  [data-clean-root="true"] .section[data-variant="home-hero-2024"] .section__title {
    text-shadow: 0 2px 12px rgba(0,0,0,.45);
    letter-spacing:.01em;
  }
  [data-clean-root="true"] .section[data-variant="home-hero-2024"] .section__lead {
    text-shadow: 0 1px 6px rgba(0,0,0,.35);
  }
  /* Scroll cue */
  [data-clean-root="true"] .section[data-variant="home-hero-2024"]::after {
    content:"";
    position:absolute; left:50%; bottom:24px; transform:translateX(-50%);
    width:32px; height:48px; border-radius:24px;
    border:2px solid rgba(255,248,231,.9);
    box-shadow: 0 0 18px rgba(255,248,231,.25);
    background:
      radial-gradient(6px 6px at 50% 22%, rgba(255,248,231,.9) 60%, transparent 61%);
    animation: float-subtle 4s ease-in-out infinite;
    z-index:3;
  }
  /* Hero CTA micro spacing */
  [data-clean-root="true"] .section[data-variant="home-hero-2024"] .section__actions {
    gap: var(--space-16);
  }

  /* --------------------------------------
     4) ALTERNATING BLOCKS – luxe cards, zig-zag, thread divider
     Usage: <Section variant="alternating-blocks-luxe">
              <div className="alternating-blocks__container"> ... </div>
            </Section>
     Inside: .alternating-blocks__item (image + copy)
  --------------------------------------- */
  /* Card polish */
  [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__item {
    background: color-mix(in srgb, var(--bg-surface) 85%, white 15%);
    border: 1px solid color-mix(in srgb, var(--theme-border-subtle, rgba(0,0,0,.12)) 70%, transparent);
    box-shadow:
      0 22px 60px rgba(0,0,0,.14),
      0 6px 18px rgba(157,107,123,.12); /* rose-tinted lift */
    border-radius: 18px;
    overflow: clip;
    position:relative;
  }
  /* Thin "gold thread" through the layout */
  [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__container {
    position:relative;
  }
  [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__container::before {
    content:""; position:absolute; left:0; right:0; top:0; bottom:0; margin:auto;
    width: 2px; height: 100%;
    background: var(--divider-gold);
    opacity:.25;
    transform: translateX(calc((min(100vw, var(--rail-content)) / 2)));
    pointer-events:none;
  }
  /* Zig-zag: even rows swap columns (image/text) on wide screens */
  @media (min-width: 901px) {
    [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__item:nth-child(even) {
      grid-template-columns: 1fr 1fr;
    }
    [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__item:nth-child(even) .alternating-blocks__image { order: 2; }
    [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__item:nth-child(even) .alternating-blocks__content { order: 1; }
  }
  /* Image masks & hover lift */
  [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__image img {
    display:block; width:100%; height:100%; object-fit:cover;
    clip-path: inset(0 round 14px);
    transition: transform .6s cubic-bezier(.2,.6,.2,1);
  }
  [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__item:hover .alternating-blocks__image img {
    transform: scale(1.03);
  }
  /* Number badge (optional) */
  [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__number {
    display:inline-grid; place-items:center;
    min-width:40px; height:40px; border-radius:999px;
    background: color-mix(in srgb, var(--theme-accent-rose) 16%, white 84%);
    color:#5a3f4a; font-weight:600;
    box-shadow: 0 6px 18px rgba(157,107,123,.18);
  }

  /* Mobile reset: vertical stack & soft separators */
  @media (max-width: 900px) {
    [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__container::before { display:none; }
    [data-clean-root="true"] .section[data-variant="alternating-blocks-luxe"] .alternating-blocks__item {
      box-shadow: 0 10px 30px rgba(0,0,0,.10);
    }
  }

  /* --------------------------------------
     5) GALLERY – rose-tint hover + staggered reveal
     Usage: <Section variant="gallery-rose-grid">
              <div className="wedding-gallery" data-anim="stagger"> ... </div>
            </Section>
  --------------------------------------- */
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .wedding-gallery {
    margin-top: clamp(2rem, 4vw, 3rem);
  }
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .gallery-item {
    position:relative; overflow:clip; border-radius:14px;
    box-shadow: 0 16px 40px rgba(0,0,0,.16);
    transition: transform .4s cubic-bezier(.2,.6,.2,1), box-shadow .4s cubic-bezier(.2,.6,.2,1);
  }
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .gallery-item::after {
    content:""; position:absolute; inset:0; pointer-events:none;
    background: linear-gradient(180deg, rgba(157,107,123,.0) 40%, rgba(157,107,123,.22) 100%);
    mix-blend-mode:multiply; opacity:0; transition:opacity .35s ease;
  }
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .gallery-item:hover {
    transform: translateY(-6px);
    box-shadow: 0 24px 60px rgba(0,0,0,.22);
  }
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .gallery-item:hover::after { opacity:1; }
  /* Stagger (optional: add data-anim on grid) */
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .wedding-gallery[data-anim="stagger"] .gallery-item {
    opacity:0; transform: translateY(14px);
    animation: gallery-in .7s cubic-bezier(.2,.6,.2,1) forwards;
  }
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .wedding-gallery[data-anim="stagger"] .gallery-item:nth-child(1){animation-delay:.02s}
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .wedding-gallery[data-anim="stagger"] .gallery-item:nth-child(2){animation-delay:.08s}
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .wedding-gallery[data-anim="stagger"] .gallery-item:nth-child(3){animation-delay:.14s}
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .wedding-gallery[data-anim="stagger"] .gallery-item:nth-child(4){animation-delay:.20s}
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .wedding-gallery[data-anim="stagger"] .gallery-item:nth-child(5){animation-delay:.26s}
  [data-clean-root="true"] .section[data-variant="gallery-rose-grid"] .wedding-gallery[data-anim="stagger"] .gallery-item:nth-child(6){animation-delay:.32s}

  /* --------------------------------------
     6) STACKABLE VARIANTS (User Live Tweaks)
     These are surgical tokens that can be mixed/matched.
     Usage: variant={['centered-content-rails','header-center-wide']}
     or     variant="centered-content-rails header-center-wide"
  --------------------------------------- */

  /* A) centered-content-rails
     Centers rails with max-width: var(--rail-content) (no gutter math) */
  [data-clean-root="true"] .section[data-variant~="centered-content-rails"] .section__rail {
    position: relative;
    z-index: 2;
    width: 100%;
    margin-inline: auto;
    padding-inline: 0;
  }

  [data-clean-root="true"] .section[data-variant~="centered-content-rails"][data-align="center"] .section__rail {
    padding-inline: var(--rail-gutter);
  }

  [data-clean-root="true"] .section[data-variant~="centered-content-rails"] .section__rail[data-width="content"] {
    max-width: var(--rail-content);
  }

  /* B) header-center-wide
     Removes 900px max-width clamp on centered headers */
  [data-clean-root="true"] .section[data-variant~="header-center-wide"] .section__header[data-align="center"] {
    text-align: center;
    margin-left: auto;
    margin-right: auto;
    max-width: none; /* <-- removes 900px clamp */
  }

  /* C) tone-auto-inherit
     Ensures color: inherit on tone="auto" sections */
  [data-clean-root="true"] .section[data-variant~="tone-auto-inherit"][data-tone="auto"] {
    color: inherit;
  }

  /* D) box-sizing-content
     Sets box-sizing to content-box (overrides border-box reset) */
  [data-clean-root="true"] .section[data-variant~="box-sizing-content"],
  [data-clean-root="true"] .section[data-variant~="box-sizing-content"] * {
    box-sizing: content-box;
  }

  /* E) lead-full-width
     Removes max-width constraint on lead text */
  [data-clean-root="true"] .section[data-variant~="lead-full-width"] .section__lead {
    max-width: none;
  }

  /* F) spaces-layout
     Full-width centered layout matching Discover Our Spaces section
     - Uses token for maintainability
     - centered with auto margins
     - Custom gutter for spacing consistency with Spaces section */
  [data-clean-root="true"] .section[data-variant~="spaces-layout"] .section__rail {
    max-width: var(--rail-content);
    margin-inline: auto;
    padding-inline: clamp(50px, 5vw, 80px);
  }

  [data-clean-root="true"] .section[data-variant~="spaces-layout"] .section__header {
    text-align: center;
  }

  /* --------------------------------------
     7) RAIL CONTAINER MATH FIX
     Ensures content area == token width with border-box.
     Fixes "too narrow" issue by properly accounting for padding.
     Usage: variant={['rail-container-math', ...other variants]}
  --------------------------------------- */
  [data-clean-root="true"] .section[data-variant~="rail-container-math"] .section__rail {
    --rail-limit: var(--rail-content);
    box-sizing: border-box;
    width: 100%;
    max-width: calc(var(--rail-limit) + (var(--rail-gutter) * 2));
    padding-inline: var(--rail-gutter);
  }

  /* Map width tokens to --rail-limit */
  [data-clean-root="true"] .section[data-variant~="rail-container-math"] .section__rail[data-width="prose"]   { --rail-limit: var(--rail-prose); }
  [data-clean-root="true"] .section[data-variant~="rail-container-math"] .section__rail[data-width="content"] { --rail-limit: var(--rail-content); }
  [data-clean-root="true"] .section[data-variant~="rail-container-math"] .section__rail[data-width="wide"]    { --rail-limit: var(--rail-wide); }
  [data-clean-root="true"] .section[data-variant~="rail-container-math"] .section__rail[data-width="full"]    { --rail-limit: 9999px; }

  /* Deterministic centering (no body margin dependency) */
  [data-clean-root="true"] .section[data-variant~="rail-container-math"][data-align="center"] .section__rail { margin-inline: auto; }
  [data-clean-root="true"] .section[data-variant~="rail-container-math"][data-align="left"]   .section__rail { margin-left: 0; margin-right: auto; }
  [data-clean-root="true"] .section[data-variant~="rail-container-math"][data-align="right"]  .section__rail { margin-left: auto; margin-right: 0; }

  /* --------------------------------------
     8) DEBUG RAILS
     Visualize rail boundaries and padding areas for development.
     Usage: variant={['debug-rails', ...]}
  --------------------------------------- */
  [data-clean-root="true"] .section[data-variant~="debug-rails"] .section__rail {
    outline: 1px dashed color-mix(in srgb, currentColor 25%, transparent);
    background: linear-gradient(90deg,
      transparent var(--rail-gutter),
      color-mix(in srgb, currentColor 6%, transparent) 0 calc(100% - var(--rail-gutter)),
      transparent 0
    );
  }

  /* ============================================================================
     CONTAINER QUERY REFINEMENTS (Progressive Enhancement)
     - Enabled when data-cq="on" flag is set on Section
     - Typography scaling based on container width (not viewport)
     - Grid/layout switches based on content-rail width
     - Progressive enhancement via @supports
     ============================================================================ */
  @supports (container-type: inline-size) {

    /* Typography Scale: Base (< --cq-sm) */
    [data-clean-root="true"] .section[data-cq="on"] .section__title {
      font-size: clamp(1.75rem, 3vw, 2rem);
    }

    /* Typography Scale: Small containers (>= --cq-sm) */
    @container section (width >= var(--cq-sm)) {
      [data-clean-root="true"] .section[data-cq="on"] .section__title {
        font-size: clamp(2rem, 3.5vw, 2.5rem);
      }
      [data-clean-root="true"] .section[data-cq="on"] .section__lead {
        max-width: 70ch; /* Relax measure as container grows */
      }
    }

    /* Typography Scale: Medium containers (>= --cq-md) */
    @container section (width >= var(--cq-md)) {
      [data-clean-root="true"] .section[data-cq="on"] .section__title {
        font-size: clamp(2.25rem, 3.75vw, 3rem);
        text-wrap: balance; /* Enable text balancing on larger containers */
      }
      [data-clean-root="true"] .section[data-cq="on"] .section__lead {
        font-size: clamp(1.0625rem, 2.5vw, 1.1875rem);
      }
    }

    /* Grid/Layout: Alternating Blocks switches at content-rail width */
    @container content-rail (width >= var(--cq-sm)) {
      [data-clean-root="true"] .section[data-cq="on"] .alternating-blocks__item {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-32);
        align-items: center;
      }
      [data-clean-root="true"] .section[data-cq="on"] .alternating-blocks__item--reverse {
        grid-auto-flow: dense;
      }
    }

    /* Grid/Layout: Gallery grid at medium containers */
    @container content-rail (width >= var(--cq-md)) {
      [data-clean-root="true"] .section[data-cq="on"] .gallery__grid {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      }
    }

    /* Layout: Two-column content layout at large containers */
    @container section (width >= var(--cq-lg)) {
      [data-clean-root="true"] .section[data-cq="on"] .section__content--columns {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: var(--space-48);
      }
    }

  } /* End @supports container queries */

}
